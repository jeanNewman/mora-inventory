import{h as V,y as M,c as T,I as Te,a7 as Re,a8 as $e,a9 as Ie,r as p,aa as Le,ab as Ve,ac as Ae,ad as Oe,ae as De,w as B,J as ee,af as ae,ag as te,L as He,ah as Be,g as ze,z as Me,Y as Ne,k as d,l as h,m as t,R as oe,j as s,S as L,p as E,d as a,q as Q,Q as de,s as ce,ai as me,a2 as U,aj as Fe,V as fe,ak as ge,n as A,al as je,a4 as pe,am as N,u as We,an as Je,ao as Ye,F as ve,ap as Ge,U as Ke,o as Xe,aq as Ze,ar as ea,x as O,a3 as re,v as aa,a1 as ta,as as oa}from"./index.27345aab.js";import{Q as F,a as ra,b as la}from"./QDrawer.0d174b05.js";import{u as sa,v as le,a as na,p as se,b as ia,c as ua,r as ne,s as da,d as ie,e as ca,Q as R,f as j,g as he,h as ma,i as fa}from"./QMenu.7be168b6.js";import{Q as W}from"./QToolbar.2291239e.js";import{C as ga,Q as pa}from"./ClosePopup.fb84b72d.js";import{Q as va,a as ha}from"./QLayout.8ba8a7fd.js";import{Q as wa,_ as we}from"./ErrorsBanner.182da272.js";import{u as _a,_ as ba}from"./useLogin.0f36d2a6.js";import{_ as ya}from"./plugin-vue_export-helper.21dcd24c.js";import Ca from"./supabase.ebda3817.js";import"./QResizeObserver.274ea83e.js";import"./QBanner.eeb49862.js";import"./index.ec59db62.js";const Sa=V("div",{class:"q-space"});var ue=M({name:"QSpace",setup(){return()=>Sa}});const ka=["top","middle","bottom"];var Pa=M({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:e=>ka.includes(e)}},setup(e,{slots:o}){const r=T(()=>e.align!==void 0?{verticalAlign:e.align}:null),l=T(()=>{const n=e.outline===!0&&e.color||e.textColor;return`q-badge flex inline items-center no-wrap q-badge--${e.multiLine===!0?"multi":"single"}-line`+(e.outline===!0?" q-badge--outline":e.color!==void 0?` bg-${e.color}`:"")+(n!==void 0?` text-${n}`:"")+(e.floating===!0?" q-badge--floating":"")+(e.rounded===!0?" q-badge--rounded":"")+(e.transparent===!0?" q-badge--transparent":"")});return()=>V("div",{class:l.value,style:r.value,role:"alert","aria-label":e.label},Te(o.default,e.label!==void 0?[e.label]:[]))}}),z=M({name:"QTooltip",inheritAttrs:!1,props:{...sa,...Re,...$e,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{default:"jump-down"},transitionHide:{default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:le},self:{type:String,default:"top middle",validator:le},offset:{type:Array,default:()=>[14,14],validator:na},scrollTarget:{default:void 0},delay:{type:Number,default:0},hideDelay:{type:Number,default:0}},emits:[...Ie],setup(e,{slots:o,emit:r,attrs:l}){let n,m;const _=ze(),{proxy:{$q:u}}=_,v=p(null),f=p(!1),c=T(()=>se(e.anchor,u.lang.rtl)),b=T(()=>se(e.self,u.lang.rtl)),k=T(()=>e.persistent!==!0),{registerTick:i,removeTick:y}=Le(),{registerTimeout:P,removeTimeout:w}=Ve(),{transition:C,transitionStyle:S}=Ae(e,f),{localScrollTarget:J,changeScrollEvent:_e,unconfigureScrollTarget:be}=ia(e,X),{anchorEl:x,canShow:ye,anchorEvents:$}=ua({showing:f,configureAnchorEl:Ue}),{show:Ce,hide:D}=Oe({showing:f,canShow:ye,handleShow:ke,handleHide:Pe,hideOnRouteChange:k,processOnMount:!0});Object.assign($,{delayShow:xe,delayHide:Ee});const{showPortal:Y,hidePortal:G,renderPortal:Se}=De(_,v,Qe);if(u.platform.is.mobile===!0){const g={anchorEl:x,innerRef:v,onClickOutside(q){return D(q),q.target.classList.contains("q-dialog__backdrop")&&Ne(q),!0}},H=T(()=>e.modelValue===null&&e.persistent!==!0&&f.value===!0);B(H,q=>{(q===!0?ca:ne)(g)}),ee(()=>{ne(g)})}function ke(g){y(),w(),Y(),i(()=>{m=new MutationObserver(()=>I()),m.observe(v.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),I(),X()}),n===void 0&&(n=B(()=>u.screen.width+"|"+u.screen.height+"|"+e.self+"|"+e.anchor+"|"+u.lang.rtl,I)),P(()=>{Y(!0),r("show",g)},e.transitionDuration)}function Pe(g){y(),w(),G(),K(),P(()=>{G(!0),r("hide",g)},e.transitionDuration)}function K(){m!==void 0&&(m.disconnect(),m=void 0),n!==void 0&&(n(),n=void 0),be(),ae($,"tooltipTemp")}function I(){const g=v.value;x.value===null||!g||da({el:g,offset:e.offset,anchorEl:x.value,anchorOrigin:c.value,selfOrigin:b.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function xe(g){if(u.platform.is.mobile===!0){ie(),document.body.classList.add("non-selectable");const H=x.value,q=["touchmove","touchcancel","touchend","click"].map(Z=>[H,Z,"delayHide","passiveCapture"]);te($,"tooltipTemp",q)}P(()=>{Ce(g)},e.delay)}function Ee(g){w(),u.platform.is.mobile===!0&&(ae($,"tooltipTemp"),ie(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),P(()=>{D(g)},e.hideDelay)}function Ue(){if(e.noParentEvent===!0||x.value===null)return;const g=u.platform.is.mobile===!0?[[x.value,"touchstart","delayShow","passive"]]:[[x.value,"mouseenter","delayShow","passive"],[x.value,"mouseleave","delayHide","passive"]];te($,"anchor",g)}function X(){if(x.value!==null||e.scrollTarget!==void 0){J.value=He(x.value,e.scrollTarget);const g=e.noParentEvent===!0?I:D;_e(J.value,g)}}function qe(){return f.value===!0?V("div",{...l,ref:v,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",l.class],style:[l.style,S.value],role:"complementary"},Me(o.default)):null}function Qe(){return V(Be,{name:C.value,appear:!0},qe)}return ee(K),Object.assign(_.proxy,{updatePosition:I}),Se}}),xa="/assets/logo.3dcf6567.png";const Ea={__name:"UpdatePasswordForm",props:{email:{required:!1,type:String,default:null},currentPassword:{required:!1,type:String,default:null},password:{required:!0,type:String},passwordConfirmation:{required:!1,type:String,default:null},validationErrors:{required:!1,type:Object,default(){return{}}}},emits:["update:email","update:currentPassword","update:password","update:passwordConfirmation"],setup(e,{emit:o}){return(r,l)=>(d(),h(s(wa),null,{default:t(()=>{var n,m,_,u,v,f,c,b,k,i,y,P;return[oe(r.$slots,"top"),typeof e.email=="string"?(d(),h(s(L),{key:0,filled:"",label:"Email","model-value":e.email,error:!!((n=e.validationErrors)!=null&&n.email),"error-message":(_=(m=e.validationErrors)==null?void 0:m.email)==null?void 0:_[0],class:"q-mb-md","hide-bottom-space":"","onUpdate:modelValue":l[0]||(l[0]=w=>o("update:email",w))},null,8,["model-value","error","error-message"])):E("",!0),typeof e.currentPassword=="string"?(d(),h(s(L),{key:1,filled:"",type:"password",label:"Current Password","model-value":e.currentPassword,error:!!((u=e.validationErrors)!=null&&u.current_password),"error-message":(f=(v=e.validationErrors)==null?void 0:v.current_password)==null?void 0:f[0],class:"q-mb-lg","hide-bottom-space":"","onUpdate:modelValue":l[1]||(l[1]=w=>o("update:currentPassword",w))},null,8,["model-value","error","error-message"])):E("",!0),typeof e.password=="string"?(d(),h(s(L),{key:2,filled:"",type:"password",label:"New Password","model-value":e.password,error:!!((c=e.validationErrors)!=null&&c.password),"error-message":(k=(b=e.validationErrors)==null?void 0:b.password)==null?void 0:k[0],class:"q-mb-sm","hide-bottom-space":"","onUpdate:modelValue":l[2]||(l[2]=w=>o("update:password",w))},null,8,["model-value","error","error-message"])):E("",!0),typeof e.passwordConfirmation=="string"?(d(),h(s(L),{key:3,filled:"",type:"password",label:"Confirm New Password","model-value":e.passwordConfirmation,error:!!((i=e.validationErrors)!=null&&i.password_confirmation),"error-message":(P=(y=e.validationErrors)==null?void 0:y.password_confirmation)==null?void 0:P[0],class:"q-mb-sm","hide-bottom-space":"","onUpdate:modelValue":l[3]||(l[3]=w=>o("update:passwordConfirmation",w))},null,8,["model-value","error","error-message"])):E("",!0),oe(r.$slots,"bottom")]}),_:3}))}},Ua=U("Confirm Identity"),qa=U(" When making sensitive changes to your account, we ask you to login again if it's been a while. "),Qa={__name:"ReauthenticateDialog",setup(e){const{isReauthenticating:o,form:r,validationErrors:l,login:n,hasErrors:m,errors:_,loading:u,resetForm:v,attemptSetEmailOnForm:f}=_a();o.value=!0;const c=p();f();async function b(){await n(),m.value||c.value.hide()}return(k,i)=>(d(),h(me,{ref_key:"dialogComponent",ref:c,onHide:s(v),onShow:s(f)},{default:t(()=>[a(ce,{style:{"max-width":"300px"},class:"full-width"},{default:t(()=>[a(W,null,{default:t(()=>[a(F,null,{default:t(()=>[Ua]),_:1}),a(Q,{icon:"question_mark",color:"primary",size:"sm",round:"",flat:""},{default:t(()=>[a(z,{class:"bg-primary","max-width":"300px",style:{"font-size":"1.2em"},anchor:"bottom right",self:"top right"},{default:t(()=>[qa]),_:1})]),_:1})]),_:1}),a(de,null,{default:t(()=>[a(ba,{email:s(r).email,"onUpdate:email":i[0]||(i[0]=y=>s(r).email=y),password:s(r).password,"onUpdate:password":i[1]||(i[1]=y=>s(r).password=y),"validation-errors":s(l)},null,8,["email","password","validation-errors"]),s(m)?(d(),h(we,{key:0,errors:s(_)},null,8,["errors"])):E("",!0)]),_:1}),a(Q,{class:"full-width",label:"Login",color:"primary",loading:s(u),onClick:b},null,8,["loading"])]),_:1})]),_:1},8,["onHide","onShow"]))}};var Ta=()=>{const{form:e,update:o,loading:r,errors:l,hasErrors:n,validationErrors:m,hasValidationErrors:_,requiresReauthentication:u,resetErrors:v,resetForm:f}=Fe();return{update:o,form:e,resetForm:f,loading:r,requiresReauthentication:u,errors:l,hasErrors:n,validationErrors:m,hasValidationErrors:_,resetErrors:v}};const Ra=U("Change Password"),$a={key:0},Ia={__name:"UpdatePasswordDialog",setup(e){var P;const o=p(),{form:r,loading:l,requiresReauthentication:n,errors:m,hasErrors:_,update:u,validationErrors:v,hasValidationErrors:f,resetErrors:c,resetForm:b}=Ta();async function k(){c(),await u(),_.value||o.value.hide()}const{user:i}=fe();typeof r.value.email=="string"&&((P=i.value)==null?void 0:P.email)&&(r.value.email=i.value.email);const y=p(!1);return n!==void 0&&B(n,w=>{w&&(y.value=!0)}),(w,C)=>(d(),h(me,pe({ref_key:"dialogComponent",ref:o},w.$attrs,{onHide:s(b)}),{default:t(()=>[a(ce,null,{default:t(()=>[a(W,null,{default:t(()=>[a(F,null,{default:t(()=>[Ra]),_:1}),ge(a(Q,{icon:"close",round:"",flat:""},null,512),[[ga]])]),_:1}),a(de,null,{default:t(()=>[a(Ea,{email:s(r).email,"onUpdate:email":C[0]||(C[0]=S=>s(r).email=S),"current-password":s(r).current_password,"onUpdate:current-password":C[1]||(C[1]=S=>s(r).current_password=S),password:s(r).password,"onUpdate:password":C[2]||(C[2]=S=>s(r).password=S),"password-confirmation":s(r).password_confirmation,"onUpdate:password-confirmation":C[3]||(C[3]=S=>s(r).password_confirmation=S),"validation-errors":s(v)},null,8,["email","current-password","password","password-confirmation","validation-errors"]),s(f)?E("",!0):(d(),A("div",$a,[a(we,{errors:s(m)},null,8,["errors"])]))]),_:1}),a(Q,{label:"update",loading:s(l),class:"full-width",color:"primary",onClick:k,onContextmenu:C[4]||(C[4]=je(S=>y.value=!0,["prevent"]))},null,8,["loading"]),s(n)!==void 0?(d(),h(Qa,{key:0,modelValue:y.value,"onUpdate:modelValue":C[5]||(C[5]=S=>y.value=S)},null,8,["modelValue"])):E("",!0)]),_:1})]),_:1},16,["onHide"]))}},La={},Va=U(" Cambiar Password ");function Aa(e,o){return d(),h(j,pe({clickable:""},e.$attrs),{default:t(()=>[a(R,{side:""},{default:t(()=>[a(N,{name:"key"})]),_:1}),a(R,null,{default:t(()=>[Va]),_:1})]),_:1},16)}var Oa=ya(La,[["render",Aa]]),Da=()=>{const e=We(),{logout:o,loading:r}=Je();async function l(){await o(),e.push("/login")}return{logout:o,loading:r,onLogoutClicked:l}};const Ha=U(" Logout "),Ba={__name:"LogoutItem",setup(e){const{loading:o,onLogoutClicked:r}=Da();return(l,n)=>(d(),h(j,{clickable:"",onClick:s(r)},{default:t(()=>[a(R,{side:""},{default:t(()=>[s(o)?(d(),h(Ye,{key:1,size:"sm",color:"primary"})):(d(),h(N,{key:0,name:"logout"}))]),_:1}),a(R,null,{default:t(()=>[Ha]),_:1})]),_:1},8,["onClick"]))}},za={__name:"AccountMenu",setup(e){const o=p(!1);return(r,l)=>(d(),A(ve,null,[a(ma,{"auto-close":""},{default:t(()=>[a(he,null,{default:t(()=>[a(Ba),a(Oa,{onClick:l[0]||(l[0]=n=>o.value=!0)})]),_:1})]),_:1}),a(Ia,{modelValue:o.value,"onUpdate:modelValue":l[1]||(l[1]=n=>o.value=n)},null,8,["modelValue"])],64))}},Ma=Ge("user",{state:()=>({user:{RoleId:"",UserId:"",Role:"",Email:""}}),getters:{returnUserRole(e){return e.user}},actions:{addUserRole(e){this.user.RoleId=e.RoleId,this.user.Role=e.Role,this.user.UserId=e.UserId,this.user.Email=e.Email,console.log("output->info",e)}}});const Na=O("img",{src:xa},null,-1),Fa={class:"q-ml-sm"},ja={class:"q-gutter-sm row items-center no-wrap"},Wa=U(" 2 "),Ja=U("Notificaciones"),Ya=O("img",{src:"https://cdn.quasar.dev/img/boy-avatar.png"},null,-1),Ga=U("Usuario"),dt={__name:"PrincipalLayout",setup(e){const{user:o}=fe();Ke();const{supabase:r}=Ca(),l=p(!1);p(""),p(!1),p(!1),p(""),p(""),p(""),p(""),p("Any time");const n=Ma();Xe(async()=>{let c=await r.from("bizrolebyuser").select("*,bizrole(*)").eq("userid",o.value.id);if(c.data.length==0){const{data:b,error:k}=await r.from("bizrolebyuser").insert([{roleid:"2b6043a0-b54d-4343-a692-abbf90b74d79",userid:o.value.id,email:o.value.email}]);console.log(k);let i={UserId:o.value.id,RoleId:"2b6043a0-b54d-4343-a692-abbf90b74d79",Role:"NA",Email:o.value.email};n.addUserRole(i)}else{let b={UserId:o.value.id,RoleId:c.data[0].roleid,Role:c.data[0].bizrole.role,Email:c.data[0].email};n.addUserRole(b)}});function m(c){return c.permise.indexOf(n.user.Role)!==-1}function _(){l.value=!l.value}const u=Ze();u.charAt(0).toUpperCase()+u.slice(1);const v=p(o.value.email),f=p([{icon:"fas fa-desktop",text:"Escritorio",route:"/dashboard",permise:"SuperAdmin,Administradores,Controller,Usuarios"},{icon:"fas fa-dolly-flatbed",text:"Plantilla de Inventario",route:"/managerinventorytemplate",permise:"SuperAdmin,Controller"},{icon:"fas fa-check-double",text:"Inventario F\xEDsico",route:"/managerinventory",permise:"SuperAdmin,Administradores,Controller,Usuarios"},{icon:"fas fa-user-tag",text:"Usuario Role",route:"/userrole",permise:"SuperAdmin"}]);return(c,b)=>{const k=ea("router-view");return d(),h(va,{view:"hHh lpR fFf",class:"bg-grey-1"},{default:t(()=>[a(ra,{elevated:"",class:"bg-white text-grey-8","height-hint":"64"},{default:t(()=>[a(W,{class:"__toolbar"},{default:t(()=>[a(Q,{flat:"",dense:"",round:"",onClick:_,"aria-label":"Menu",icon:"menu",class:"q-mr-sm"}),c.$q.screen.width>400?(d(),h(F,{key:0,shrink:"",class:"row items-center no-wrap"},{default:t(()=>[Na,O("span",Fa,re(v.value),1)]),_:1})):E("",!0),a(ue),a(ue),O("div",ja,[a(Q,{round:"",dense:"",flat:"",color:"grey-8",icon:"notifications"},{default:t(()=>[a(Pa,{color:"red","text-color":"white",floating:""},{default:t(()=>[Wa]),_:1}),a(z,null,{default:t(()=>[Ja]),_:1})]),_:1}),a(Q,{round:"",flat:""},{default:t(()=>[a(aa,{size:"26px"},{default:t(()=>[Ya]),_:1}),a(z,null,{default:t(()=>[Ga]),_:1}),a(za)]),_:1})])]),_:1})]),_:1}),a(la,{modelValue:l.value,"onUpdate:modelValue":b[0]||(b[0]=i=>l.value=i),"show-if-above":"",bordered:"",class:"bg-white",width:250},{default:t(()=>[a(pa,{class:"fit"},{default:t(()=>[a(he,{padding:"",class:"text-grey-8"},{default:t(()=>[(d(!0),A(ve,null,ta(f.value,i=>(d(),A("div",{key:i.text},[m(i)?ge((d(),h(j,{key:0,class:"__drawer-item",clickable:"",to:i.route},{default:t(()=>[a(R,{avatar:""},{default:t(()=>[a(N,{name:i.icon},null,8,["name"])]),_:2},1024),a(R,null,{default:t(()=>[a(fa,null,{default:t(()=>[U(re(i.text),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"])),[[oa]]):E("",!0)]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(ha,null,{default:t(()=>[a(k)]),_:1})]),_:1})}}};export{dt as default};
